(function(i){var p=function(a){return a.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},B=1,e,q,r,n=function(a){return a&&i.isFunction(a.always)},C=function(a){var b=[];if(n(a))return[a];else for(var c in a)n(a[c])&&b.push(a[c]);return b},v=function(a){return i.isArray(a)&&a.length===3&&a[1]==="success"?a[0]:a};e=i.View=function(a,b,c,d){if(typeof c==="function"){d=c;c=undefined}var f=C(b);if(f.length){var g=i.Deferred();f.push(r(a,true));i.when.apply(i,f).then(function(j){var k=i.makeArray(arguments),
l=k.pop()[0];if(n(b))b=v(j);else for(var m in b)if(n(b[m]))b[m]=v(k.shift());k=l(b,c);g.resolve(k);d&&d(k)});return g.promise()}else{var h;f=typeof d==="function";g=r(a,f);if(f){h=g;g.done(function(j){d(j(b,c))})}else g.done(function(j){h=j(b,c)});return h}};q=function(a,b){if(!a.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+b;};r=function(a,b){return i.ajax({url:a,dataType:"view",async:b})};i.ajaxTransport("view",function(a,b){a=b.url;var c=a.match(/\.[\w\d]+$/),
d,f,g,h=a,j,k=function(l){l=d.renderer(g,l);if(e.cache)e.cached[g]=l;return{view:l}};if(f=document.getElementById(a))c=f.type.match(/\/[\d\w]+$/)[0].replace(/^\//,".");if(!c){c=e.ext;h+=e.ext}g=p(h);if(h.match(/^\/\//))h=typeof steal==="undefined"?"/"+h.substr(2):steal.root.mapJoin(h.substr(2));d=e.types[c];return{send:function(l,m){if(e.cached[g])return m(200,"success",{view:e.cached[g]});else if(f)m(200,"success",k(f.innerHTML));else j=i.ajax({async:b.async,url:h,dataType:"text",error:function(){q("",
h);m(404)},success:function(w){q(w,h);m(200,"success",k(w))}})},abort:function(){j&&j.abort()}}});i.extend(e,{hookups:{},hookup:function(a){var b=++B;e.hookups[b]=a;return b},cached:{},cache:true,register:function(a){this.types["."+a.suffix]=a;window.steal&&steal.type(a.suffix+" view js",function(b,c,d){c=e.types["."+b.type];var f=p(b.rootSrc);b.text=c.script(f,b.text);d()})},types:{},ext:".ejs",registerScript:function(a,b,c){return"$.View.preload('"+b+"',"+e.types["."+a].script(b,c)+");"},preload:function(a,
b){e.cached[a]=function(c,d){return b.call(c,c,d)}}});window.steal&&steal.type("view js",function(a,b,c){b=e.types["."+a.type];var d=p(a.rootSrc);a.text="steal('"+(b.plugin||"jquery/view/"+a.type)+"').then(function($){$.View.preload('"+d+"',"+a.text+");\n})";c()});var x,o,y,z,A,s,t;x=function(a){var b=i.fn[a];i.fn[a]=function(){var c=i.makeArray(arguments),d,f,g=this;if(n(c[0])){c[0].done(function(h){o.call(g,[h],b)});return this}else if(y(c)){if(d=A(c)){f=c[d];c[d]=function(h){o.call(g,[h],b);f.call(g,
h)};e.apply(e,c);return this}c=e.apply(e,c);if(n(c)){c.done(function(h){o.call(g,[h],b)});return this}else c=[c]}return o.call(this,c,b)}};o=function(a,b){var c;for(var d in e.hookups)break;if(d&&a[0]&&z(a[0])){c=e.hookups;e.hookups={};a[0]=i(a[0])}b=b.apply(this,a);c&&s(a[0],c);return b};y=function(a){var b=typeof a[1];return typeof a[0]=="string"&&(b=="object"||b=="function")&&!a[1].nodeType&&!a[1].jquery};z=function(a){if(a.jquery||a.nodeType===1)return true;else if(typeof a==="string"){a=i.trim(a);
return a.substr(0,1)==="<"&&a.substr(a.length-1,1)===">"&&a.length>=3}else return false};A=function(a){return typeof a[3]==="function"?3:typeof a[2]==="function"&&2};s=function(a,b){var c,d=0,f,g;a=a.filter(function(){return this.nodeType!=3});a=a.add("[data-view-id]",a);for(c=a.length;d<c;d++)if(a[d].getAttribute&&(f=a[d].getAttribute("data-view-id"))&&(g=b[f])){g(a[d],f);delete b[f];a[d].removeAttribute("data-view-id")}i.extend(e.hookups,b)};i.fn.hookup=function(){var a=e.hookups;e.hookups={};s(this,
a);return this};t=["prepend","append","after","before","text","html","replaceWith","val"];for(var u=0;u<t.length;u++)x(t[u])})(jQuery);
(function(i){var f={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowUp:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g,replacer:/\{([^\}]+)\}/g,dot:/\./},k=function(a,b,c){return a[b]!==undefined?a[b]:c&&(a[b]={})},l=function(a){return(a=typeof a)&&(a=="function"||a=="object")},m=function(a,b,c){a=a?a.split(f.dot):[];var g=a.length;b=i.isArray(b)?b:[b||window];var d,e,h,n=0;if(g==0)return b[0];for(;d=b[n++];){for(h=0;h<g-1&&l(d);h++)d=k(d,a[h],c);if(l(d)){e=k(d,a[h],c);if(e!==undefined){c===
false&&delete d[a[h]];return e}}}},j=i.String=i.extend(i.String||{},{getObject:m,capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},camelize:function(a){a=j.classize(a);return a.charAt(0).toLowerCase()+a.substr(1)},classize:function(a,b){a=a.split(f.undHash);for(var c=0;c<a.length;c++)a[c]=j.capitalize(a[c]);return a.join(b||"")},niceName:function(a){return j.classize(a," ")},underscore:function(a){return a.replace(f.colons,"/").replace(f.words,"$1_$2").replace(f.lowUp,"$1_$2").replace(f.dash,
"_").toLowerCase()},sub:function(a,b,c){var g=[];g.push(a.replace(f.replacer,function(d,e){d=m(e,b,typeof c=="boolean"?!c:c);e=typeof d;if((e==="object"||e==="function")&&e!==null){g.push(d);return""}else return""+d}));return g.length<=1?g[0]:g},_regs:f})})(jQuery);
(function(f){f.String.rsplit=function(a,e){for(var b=e.exec(a),c=[],d;b!==null;){d=b.index;if(d!==0){c.push(a.substring(0,d));a=a.slice(d)}c.push(b[0]);a=a.slice(b[0].length);b=e.exec(a)}a!==""&&c.push(a);return c}})(jQuery);
(function(h){var q=function(a){eval(a)},r=function(a){return a.substr(0,a.length-1)},m=h.String.rsplit,k=h.extend,s=h.isArray,n=function(a){return a.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"').replace(/\t/g,"\\t")},t=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").replace(/'/g,"&#39;")},f=function(a){if(this.constructor!=f){var b=new f(a);return function(c,e){return b.render(c,e)}}if(typeof a=="function"){this.template=
{};this.template.process=a}else{k(this,f.options,a);this.template=u(this.text,this.type,this.name)}};h.EJS=f;f.prototype={constructor:f,render:function(a,b){a=a||{};this._extra_helpers=b;b=new f.Helpers(a,b||{});return this.template.process.call(a,a,b)}};f.text=function(a){if(typeof a=="string")return a;if(a===null||a===undefined)return"";var b=a.hookup&&function(c,e){a.hookup.call(a,c,e)}||typeof a=="function"&&a||s(a)&&function(c,e){for(var d=0;d<a.length;d++)a[d].hookup?a[d].hookup(c,e):a[d](c,
e)};if(b)return"data-view-id='"+h.View.hookup(b)+"'";return a.toString?a.toString():""};f.clean=function(a){return typeof a=="string"?t(a):typeof a=="number"?a:f.text(a)};var o=function(a,b,c){b=m(b,/\n/);for(var e=0;e<b.length;e++)v(a,b[e],c)},v=function(a,b,c){a.lines++;b=m(b,a.splitter);for(var e,d=0;d<b.length;d++){e=b[d];e!==null&&c(e,a)}},w=function(a,b){var c={};k(c,{left:a+"%",right:"%"+b,dLeft:a+"%%",dRight:"%%"+b,eeLeft:a+"%==",eLeft:a+"%=",cmnt:a+"%#",scan:o,lines:0});c.splitter=new RegExp("("+
[c.dLeft,c.dRight,c.eeLeft,c.eLeft,c.cmnt,c.left,c.right+"\n",c.right,"\n"].join(")|(").replace(/\[/g,"\\[").replace(/\]/g,"\\]")+")");return c},u=function(a,b,c){a=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n");b=b||"<";var e=new f.Buffer(["var ___v1ew = [];"],[]),d="",p=function(i){e.push("___v1ew.push(",'"',n(i),'");')},j=null,l=function(){d=""};o(w(b,b==="["?"]":">"),a||"",function(i,g){if(j===null)switch(i){case "\n":d+="\n";p(d);e.cr();l();break;case g.left:case g.eLeft:case g.eeLeft:case g.cmnt:j=
i;d.length>0&&p(d);l();break;case g.dLeft:d+=g.left;break;default:d+=i;break}else switch(i){case g.right:switch(j){case g.left:if(d[d.length-1]=="\n"){d=r(d);e.push(d,";");e.cr()}else e.push(d,";");break;case g.eLeft:e.push("___v1ew.push(","(jQuery.EJS.clean(",d,")));");break;case g.eeLeft:e.push("___v1ew.push(","(jQuery.EJS.text(",d,")));");break}j=null;l();break;case g.dRight:d+=g.right;break;default:d+=i;break}});d.length>0&&e.push("___v1ew.push(",'"',n(d)+'");');a={out:"try { with(_VIEW) { with (_CONTEXT) {"+
e.close()+" return ___v1ew.join('');}}}catch(e){e.lineNumber=null;throw e;}"};q.call(a,"this.process = (function(_CONTEXT,_VIEW){"+a.out+"});\r\n//@ sourceURL="+c+".js");return a};f.Buffer=function(a,b){this.line=[];this.script=[];this.post=b;this.push.apply(this,a)};f.Buffer.prototype={push:function(){this.line.push.apply(this.line,arguments)},cr:function(){this.script.push(this.line.join(""),"\n");this.line=[]},close:function(){if(this.line.length>0){this.script.push(this.line.join(""));this.line=
[]}this.post.length&&this.push.apply(this,this.post);this.script.push(";");return this.script.join("")}};f.options={type:"<",ext:".ejs"};f.Helpers=function(a,b){this._data=a;this._extras=b;k(this,b)};f.Helpers.prototype={plugin:function(){var a=h.makeArray(arguments),b=a.shift();return function(c){c=h(c);c[b].apply(c,a)}},view:function(a,b,c){c=c||this._extras;b=b||this._data;return h.View(a,b,c)}};h.View.register({suffix:"ejs",script:function(a,b){return"jQuery.EJS(function(_CONTEXT,_VIEW) { "+(new f({text:b,
name:a})).template.out+" })"},renderer:function(a,b){var c=new f({text:b,name:a});return function(e,d){return c.render.call(c,e,d)}}})})(jQuery);
